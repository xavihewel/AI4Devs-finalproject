0b96c915f9e0d7424825718bf2f53ad6
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = MatchFilters;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = __importStar(require("react"));
const react_i18next_1 = require("react-i18next");
const ui_1 = require("../ui");
const MatchFilterService_1 = require("./services/MatchFilterService");
const FilterStrategyFactory_1 = require("./factories/FilterStrategyFactory");
const SortStrategyFactory_1 = require("./factories/SortStrategyFactory");
const FilterPersistenceRepository_1 = require("./repositories/FilterPersistenceRepository");
function MatchFilters({ matches, onFilteredMatches, onFiltersChange }) {
    const { t } = (0, react_i18next_1.useTranslation)('matches');
    // Dependency injection following DIP
    const filterService = new MatchFilterService_1.MatchFilterService(new FilterStrategyFactory_1.ConcreteFilterStrategyFactory(), new SortStrategyFactory_1.ConcreteSortStrategyFactory());
    const persistenceRepository = new FilterPersistenceRepository_1.LocalStorageFilterRepository();
    const [filters, setFilters] = (0, react_1.useState)({
        minScore: 0,
        minSeats: 1,
        dateFrom: '',
        dateTo: '',
        sortBy: 'score',
        sortOrder: 'desc'
    });
    const [activeFiltersCount, setActiveFiltersCount] = (0, react_1.useState)(0);
    // Load filters from repository on mount
    (0, react_1.useEffect)(() => {
        const savedFilters = persistenceRepository.load();
        if (savedFilters) {
            setFilters(savedFilters);
        }
    }, []);
    // Save filters to repository whenever they change
    (0, react_1.useEffect)(() => {
        persistenceRepository.save(filters);
    }, [filters]);
    // Apply filters and sorting using service
    (0, react_1.useEffect)(() => {
        const filtered = filterService.processMatches(matches, filters);
        onFilteredMatches(filtered);
        onFiltersChange(filters);
    }, [matches, filters, onFilteredMatches, onFiltersChange, filterService]);
    // Count active filters using service
    (0, react_1.useEffect)(() => {
        const activeFilterNames = filterService.getActiveFilterNames(filters);
        setActiveFiltersCount(activeFilterNames.length);
    }, [filters, filterService]);
    const handleFilterChange = (key, value) => {
        setFilters(prev => ({
            ...prev,
            [key]: value
        }));
    };
    const clearFilters = () => {
        const defaultFilters = {
            minScore: 0,
            minSeats: 1,
            dateFrom: '',
            dateTo: '',
            sortBy: 'score',
            sortOrder: 'desc'
        };
        setFilters(defaultFilters);
        persistenceRepository.clear();
    };
    const sortOptions = [
        { value: 'score', label: t('filters.sort.score') },
        { value: 'date', label: t('filters.sort.date') },
        { value: 'seats', label: t('filters.sort.seats') }
    ];
    const orderOptions = [
        { value: 'desc', label: t('filters.order.desc') },
        { value: 'asc', label: t('filters.order.asc') }
    ];
    return ((0, jsx_runtime_1.jsx)(ui_1.Card, { children: (0, jsx_runtime_1.jsx)(ui_1.CardContent, { children: (0, jsx_runtime_1.jsxs)("div", { className: "space-y-4", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex justify-between items-center", children: [(0, jsx_runtime_1.jsx)("h3", { className: "text-lg font-semibold text-gray-900", children: t('filters.title') }), activeFiltersCount > 0 && ((0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2", children: [(0, jsx_runtime_1.jsx)("span", { className: "text-sm text-gray-500", "data-testid": "active-count", children: t('filters.activeCount', { count: activeFiltersCount }) }), (0, jsx_runtime_1.jsx)(ui_1.Button, { variant: "secondary", size: "sm", onClick: clearFilters, "data-testid": "clear-filters", children: t('filters.clear') })] }))] }), (0, jsx_runtime_1.jsxs)("div", { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4", children: [(0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsxs)("label", { className: "block text-sm font-medium text-gray-700 mb-2", children: [t('filters.minScore'), " (", filters.minScore, "%)"] }), (0, jsx_runtime_1.jsx)("input", { type: "range", min: "0", max: "100", step: "10", value: filters.minScore, onChange: (e) => handleFilterChange('minScore', parseInt(e.target.value)), className: "w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("label", { className: "block text-sm font-medium text-gray-700 mb-2", children: t('filters.minSeats') }), (0, jsx_runtime_1.jsx)(ui_1.Select, { value: filters.minSeats.toString(), onChange: (e) => handleFilterChange('minSeats', parseInt(e.target.value)), options: Array.from({ length: 8 }, (_, i) => ({
                                            value: (i + 1).toString(),
                                            label: `${i + 1} ${i === 0 ? t('filters.seat') : t('filters.seats')}`
                                        })) })] }), (0, jsx_runtime_1.jsx)("div", { children: (0, jsx_runtime_1.jsx)(ui_1.Input, { label: t('filters.dateFrom'), type: "date", value: filters.dateFrom, onChange: (e) => handleFilterChange('dateFrom', e.target.value) }) }), (0, jsx_runtime_1.jsx)("div", { children: (0, jsx_runtime_1.jsx)(ui_1.Input, { label: t('filters.dateTo'), type: "date", value: filters.dateTo, onChange: (e) => handleFilterChange('dateTo', e.target.value) }) }), (0, jsx_runtime_1.jsx)("div", { children: (0, jsx_runtime_1.jsx)(ui_1.Select, { label: t('filters.sortBy'), value: filters.sortBy, onChange: (e) => handleFilterChange('sortBy', e.target.value), options: sortOptions }) }), (0, jsx_runtime_1.jsx)("div", { children: (0, jsx_runtime_1.jsx)(ui_1.Select, { label: t('filters.sortOrder'), value: filters.sortOrder, onChange: (e) => handleFilterChange('sortOrder', e.target.value), options: orderOptions }) })] }), activeFiltersCount > 0 && ((0, jsx_runtime_1.jsxs)("div", { className: "flex flex-wrap gap-2", "data-testid": "active-filters", children: [filters.minScore > 0 && ((0, jsx_runtime_1.jsxs)("span", { className: "inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800", "data-testid": "score-chip", children: [t('filters.scoreChip', { score: filters.minScore }), (0, jsx_runtime_1.jsx)("button", { onClick: () => handleFilterChange('minScore', 0), className: "ml-1 text-blue-600 hover:text-blue-800", children: "\u00D7" })] })), filters.minSeats > 1 && ((0, jsx_runtime_1.jsxs)("span", { className: "inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800", "data-testid": "seats-chip", children: [t('filters.seatsChip', { seats: filters.minSeats }), (0, jsx_runtime_1.jsx)("button", { onClick: () => handleFilterChange('minSeats', 1), className: "ml-1 text-green-600 hover:text-green-800", children: "\u00D7" })] })), filters.dateFrom && ((0, jsx_runtime_1.jsxs)("span", { className: "inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800", "data-testid": "date-from-chip", children: [t('filters.fromChip', { date: new Date(filters.dateFrom).toLocaleDateString() }), (0, jsx_runtime_1.jsx)("button", { onClick: () => handleFilterChange('dateFrom', ''), className: "ml-1 text-purple-600 hover:text-purple-800", children: "\u00D7" })] })), filters.dateTo && ((0, jsx_runtime_1.jsxs)("span", { className: "inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800", "data-testid": "date-to-chip", children: [t('filters.toChip', { date: new Date(filters.dateTo).toLocaleDateString() }), (0, jsx_runtime_1.jsx)("button", { onClick: () => handleFilterChange('dateTo', ''), className: "ml-1 text-purple-600 hover:text-purple-800", children: "\u00D7" })] }))] }))] }) }) }));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9BSTREZXZzLWZpbmFscHJvamVjdC9Gcm9udGVuZC9zcmMvY29tcG9uZW50cy9tYXRjaGVzL01hdGNoRmlsdGVycy50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUF3QkEsK0JBeU9DOztBQWpRRCwrQ0FBbUQ7QUFDbkQsaURBQStDO0FBRS9DLDhCQUFpRTtBQUNqRSxzRUFBbUU7QUFDbkUsNkVBQWtGO0FBQ2xGLHlFQUE4RTtBQUM5RSw0RkFBMEY7QUFpQjFGLFNBQXdCLFlBQVksQ0FBQyxFQUNuQyxPQUFPLEVBQ1AsaUJBQWlCLEVBQ2pCLGVBQWUsRUFDRztJQUNsQixNQUFNLEVBQUUsQ0FBQyxFQUFFLEdBQUcsSUFBQSw4QkFBYyxFQUFDLFNBQVMsQ0FBQyxDQUFDO0lBRXhDLHFDQUFxQztJQUNyQyxNQUFNLGFBQWEsR0FBRyxJQUFJLHVDQUFrQixDQUMxQyxJQUFJLHFEQUE2QixFQUFFLEVBQ25DLElBQUksaURBQTJCLEVBQUUsQ0FDbEMsQ0FBQztJQUNGLE1BQU0scUJBQXFCLEdBQUcsSUFBSSwwREFBNEIsRUFBRSxDQUFDO0lBRWpFLE1BQU0sQ0FBQyxPQUFPLEVBQUUsVUFBVSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFnQjtRQUNwRCxRQUFRLEVBQUUsQ0FBQztRQUNYLFFBQVEsRUFBRSxDQUFDO1FBQ1gsUUFBUSxFQUFFLEVBQUU7UUFDWixNQUFNLEVBQUUsRUFBRTtRQUNWLE1BQU0sRUFBRSxPQUFPO1FBQ2YsU0FBUyxFQUFFLE1BQU07S0FDbEIsQ0FBQyxDQUFDO0lBRUgsTUFBTSxDQUFDLGtCQUFrQixFQUFFLHFCQUFxQixDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLENBQUMsQ0FBQyxDQUFDO0lBRWhFLHdDQUF3QztJQUN4QyxJQUFBLGlCQUFTLEVBQUMsR0FBRyxFQUFFO1FBQ2IsTUFBTSxZQUFZLEdBQUcscUJBQXFCLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDbEQsSUFBSSxZQUFZLEVBQUUsQ0FBQztZQUNqQixVQUFVLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDM0IsQ0FBQztJQUNILENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUVQLGtEQUFrRDtJQUNsRCxJQUFBLGlCQUFTLEVBQUMsR0FBRyxFQUFFO1FBQ2IscUJBQXFCLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3RDLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7SUFFZCwwQ0FBMEM7SUFDMUMsSUFBQSxpQkFBUyxFQUFDLEdBQUcsRUFBRTtRQUNiLE1BQU0sUUFBUSxHQUFHLGFBQWEsQ0FBQyxjQUFjLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ2hFLGlCQUFpQixDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQzVCLGVBQWUsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUMzQixDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsT0FBTyxFQUFFLGlCQUFpQixFQUFFLGVBQWUsRUFBRSxhQUFhLENBQUMsQ0FBQyxDQUFDO0lBRTFFLHFDQUFxQztJQUNyQyxJQUFBLGlCQUFTLEVBQUMsR0FBRyxFQUFFO1FBQ2IsTUFBTSxpQkFBaUIsR0FBRyxhQUFhLENBQUMsb0JBQW9CLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDdEUscUJBQXFCLENBQUMsaUJBQWlCLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDbEQsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLGFBQWEsQ0FBQyxDQUFDLENBQUM7SUFFN0IsTUFBTSxrQkFBa0IsR0FBRyxDQUFDLEdBQXdCLEVBQUUsS0FBVSxFQUFFLEVBQUU7UUFDbEUsVUFBVSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUNsQixHQUFHLElBQUk7WUFDUCxDQUFDLEdBQUcsQ0FBQyxFQUFFLEtBQUs7U0FDYixDQUFDLENBQUMsQ0FBQztJQUNOLENBQUMsQ0FBQztJQUVGLE1BQU0sWUFBWSxHQUFHLEdBQUcsRUFBRTtRQUN4QixNQUFNLGNBQWMsR0FBa0I7WUFDcEMsUUFBUSxFQUFFLENBQUM7WUFDWCxRQUFRLEVBQUUsQ0FBQztZQUNYLFFBQVEsRUFBRSxFQUFFO1lBQ1osTUFBTSxFQUFFLEVBQUU7WUFDVixNQUFNLEVBQUUsT0FBTztZQUNmLFNBQVMsRUFBRSxNQUFNO1NBQ2xCLENBQUM7UUFDRixVQUFVLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDM0IscUJBQXFCLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDaEMsQ0FBQyxDQUFDO0lBRUYsTUFBTSxXQUFXLEdBQUc7UUFDbEIsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUMsb0JBQW9CLENBQUMsRUFBRTtRQUNsRCxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQyxtQkFBbUIsQ0FBQyxFQUFFO1FBQ2hELEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLEVBQUU7S0FDbkQsQ0FBQztJQUVGLE1BQU0sWUFBWSxHQUFHO1FBQ25CLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLEVBQUU7UUFDakQsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUMsbUJBQW1CLENBQUMsRUFBRTtLQUNoRCxDQUFDO0lBRUYsT0FBTyxDQUNMLHVCQUFDLFNBQUksY0FDSCx1QkFBQyxnQkFBVyxjQUNWLGlDQUFLLFNBQVMsRUFBQyxXQUFXLGFBQ3hCLGlDQUFLLFNBQVMsRUFBQyxtQ0FBbUMsYUFDaEQsK0JBQUksU0FBUyxFQUFDLHFDQUFxQyxZQUNoRCxDQUFDLENBQUMsZUFBZSxDQUFDLEdBQ2hCLEVBQ0Ysa0JBQWtCLEdBQUcsQ0FBQyxJQUFJLENBQzNCLGlDQUFLLFNBQVMsRUFBQyx5QkFBeUIsYUFDdEMsaUNBQU0sU0FBUyxFQUFDLHVCQUF1QixpQkFBYSxjQUFjLFlBQy9ELENBQUMsQ0FBQyxxQkFBcUIsRUFBRSxFQUFFLEtBQUssRUFBRSxrQkFBa0IsRUFBRSxDQUFDLEdBQ25ELEVBQ1AsdUJBQUMsV0FBTSxJQUNMLE9BQU8sRUFBQyxXQUFXLEVBQ25CLElBQUksRUFBQyxJQUFJLEVBQ1QsT0FBTyxFQUFFLFlBQVksaUJBQ1QsZUFBZSxZQUUxQixDQUFDLENBQUMsZUFBZSxDQUFDLEdBQ1osSUFDTCxDQUNQLElBQ0csRUFFTixpQ0FBSyxTQUFTLEVBQUMsc0RBQXNELGFBRW5FLDRDQUNFLG1DQUFPLFNBQVMsRUFBQyw4Q0FBOEMsYUFDNUQsQ0FBQyxDQUFDLGtCQUFrQixDQUFDLFFBQUksT0FBTyxDQUFDLFFBQVEsVUFDcEMsRUFDUixrQ0FDRSxJQUFJLEVBQUMsT0FBTyxFQUNaLEdBQUcsRUFBQyxHQUFHLEVBQ1AsR0FBRyxFQUFDLEtBQUssRUFDVCxJQUFJLEVBQUMsSUFBSSxFQUNULEtBQUssRUFBRSxPQUFPLENBQUMsUUFBUSxFQUN2QixRQUFRLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLGtCQUFrQixDQUFDLFVBQVUsRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUN6RSxTQUFTLEVBQUMsa0VBQWtFLEdBQzVFLElBQ0UsRUFHTiw0Q0FDRSxrQ0FBTyxTQUFTLEVBQUMsOENBQThDLFlBQzVELENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxHQUNoQixFQUNSLHVCQUFDLFdBQU0sSUFDTCxLQUFLLEVBQUUsT0FBTyxDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUUsRUFDbEMsUUFBUSxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQyxVQUFVLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsRUFDekUsT0FBTyxFQUFFLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDOzRDQUM1QyxLQUFLLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFFOzRDQUN6QixLQUFLLEVBQUUsR0FBRyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxFQUFFO3lDQUN0RSxDQUFDLENBQUMsR0FDSCxJQUNFLEVBR04sMENBQ0UsdUJBQUMsVUFBSyxJQUNKLEtBQUssRUFBRSxDQUFDLENBQUMsa0JBQWtCLENBQUMsRUFDNUIsSUFBSSxFQUFDLE1BQU0sRUFDWCxLQUFLLEVBQUUsT0FBTyxDQUFDLFFBQVEsRUFDdkIsUUFBUSxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FDL0QsR0FDRSxFQUdOLDBDQUNFLHVCQUFDLFVBQUssSUFDSixLQUFLLEVBQUUsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLEVBQzFCLElBQUksRUFBQyxNQUFNLEVBQ1gsS0FBSyxFQUFFLE9BQU8sQ0FBQyxNQUFNLEVBQ3JCLFFBQVEsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsa0JBQWtCLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEdBQzdELEdBQ0UsRUFHTiwwQ0FDRSx1QkFBQyxXQUFNLElBQ0wsS0FBSyxFQUFFLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUMxQixLQUFLLEVBQUUsT0FBTyxDQUFDLE1BQU0sRUFDckIsUUFBUSxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFDN0QsT0FBTyxFQUFFLFdBQVcsR0FDcEIsR0FDRSxFQUdOLDBDQUNFLHVCQUFDLFdBQU0sSUFDTCxLQUFLLEVBQUUsQ0FBQyxDQUFDLG1CQUFtQixDQUFDLEVBQzdCLEtBQUssRUFBRSxPQUFPLENBQUMsU0FBUyxFQUN4QixRQUFRLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLGtCQUFrQixDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUNoRSxPQUFPLEVBQUUsWUFBWSxHQUNyQixHQUNFLElBQ0YsRUFHTCxrQkFBa0IsR0FBRyxDQUFDLElBQUksQ0FDekIsaUNBQUssU0FBUyxFQUFDLHNCQUFzQixpQkFBYSxnQkFBZ0IsYUFDL0QsT0FBTyxDQUFDLFFBQVEsR0FBRyxDQUFDLElBQUksQ0FDdkIsa0NBQU0sU0FBUyxFQUFDLCtGQUErRixpQkFBYSxZQUFZLGFBQ3JJLENBQUMsQ0FBQyxtQkFBbUIsRUFBRSxFQUFFLEtBQUssRUFBRSxPQUFPLENBQUMsUUFBUSxFQUFFLENBQUMsRUFDcEQsbUNBQ0UsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLGtCQUFrQixDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsRUFDaEQsU0FBUyxFQUFDLHdDQUF3Qyx1QkFHM0MsSUFDSixDQUNSLEVBQ0EsT0FBTyxDQUFDLFFBQVEsR0FBRyxDQUFDLElBQUksQ0FDdkIsa0NBQU0sU0FBUyxFQUFDLGlHQUFpRyxpQkFBYSxZQUFZLGFBQ3ZJLENBQUMsQ0FBQyxtQkFBbUIsRUFBRSxFQUFFLEtBQUssRUFBRSxPQUFPLENBQUMsUUFBUSxFQUFFLENBQUMsRUFDcEQsbUNBQ0UsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLGtCQUFrQixDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsRUFDaEQsU0FBUyxFQUFDLDBDQUEwQyx1QkFHN0MsSUFDSixDQUNSLEVBQ0EsT0FBTyxDQUFDLFFBQVEsSUFBSSxDQUNuQixrQ0FBTSxTQUFTLEVBQUMsbUdBQW1HLGlCQUFhLGdCQUFnQixhQUM3SSxDQUFDLENBQUMsa0JBQWtCLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLGtCQUFrQixFQUFFLEVBQUUsQ0FBQyxFQUNqRixtQ0FDRSxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsa0JBQWtCLENBQUMsVUFBVSxFQUFFLEVBQUUsQ0FBQyxFQUNqRCxTQUFTLEVBQUMsNENBQTRDLHVCQUcvQyxJQUNKLENBQ1IsRUFDQSxPQUFPLENBQUMsTUFBTSxJQUFJLENBQ2pCLGtDQUFNLFNBQVMsRUFBQyxtR0FBbUcsaUJBQWEsY0FBYyxhQUMzSSxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLGtCQUFrQixFQUFFLEVBQUUsQ0FBQyxFQUM3RSxtQ0FDRSxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsa0JBQWtCLENBQUMsUUFBUSxFQUFFLEVBQUUsQ0FBQyxFQUMvQyxTQUFTLEVBQUMsNENBQTRDLHVCQUcvQyxJQUNKLENBQ1IsSUFDRyxDQUNQLElBQ0csR0FDTSxHQUNULENBQ1IsQ0FBQztBQUNKLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9BSTREZXZzLWZpbmFscHJvamVjdC9Gcm9udGVuZC9zcmMvY29tcG9uZW50cy9tYXRjaGVzL01hdGNoRmlsdGVycy50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyB1c2VUcmFuc2xhdGlvbiB9IGZyb20gJ3JlYWN0LWkxOG5leHQnO1xuaW1wb3J0IHR5cGUgeyBNYXRjaER0byB9IGZyb20gJy4uLy4uL3R5cGVzL2FwaSc7XG5pbXBvcnQgeyBCdXR0b24sIENhcmQsIENhcmRDb250ZW50LCBJbnB1dCwgU2VsZWN0IH0gZnJvbSAnLi4vdWknO1xuaW1wb3J0IHsgTWF0Y2hGaWx0ZXJTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9NYXRjaEZpbHRlclNlcnZpY2UnO1xuaW1wb3J0IHsgQ29uY3JldGVGaWx0ZXJTdHJhdGVneUZhY3RvcnkgfSBmcm9tICcuL2ZhY3Rvcmllcy9GaWx0ZXJTdHJhdGVneUZhY3RvcnknO1xuaW1wb3J0IHsgQ29uY3JldGVTb3J0U3RyYXRlZ3lGYWN0b3J5IH0gZnJvbSAnLi9mYWN0b3JpZXMvU29ydFN0cmF0ZWd5RmFjdG9yeSc7XG5pbXBvcnQgeyBMb2NhbFN0b3JhZ2VGaWx0ZXJSZXBvc2l0b3J5IH0gZnJvbSAnLi9yZXBvc2l0b3JpZXMvRmlsdGVyUGVyc2lzdGVuY2VSZXBvc2l0b3J5JztcblxuZXhwb3J0IGludGVyZmFjZSBGaWx0ZXJPcHRpb25zIHtcbiAgbWluU2NvcmU6IG51bWJlcjtcbiAgbWluU2VhdHM6IG51bWJlcjtcbiAgZGF0ZUZyb206IHN0cmluZztcbiAgZGF0ZVRvOiBzdHJpbmc7XG4gIHNvcnRCeTogJ3Njb3JlJyB8ICdkYXRlJyB8ICdzZWF0cyc7XG4gIHNvcnRPcmRlcjogJ2FzYycgfCAnZGVzYyc7XG59XG5cbmludGVyZmFjZSBNYXRjaEZpbHRlcnNQcm9wcyB7XG4gIG1hdGNoZXM6IE1hdGNoRHRvW107XG4gIG9uRmlsdGVyZWRNYXRjaGVzOiAoZmlsdGVyZWRNYXRjaGVzOiBNYXRjaER0b1tdKSA9PiB2b2lkO1xuICBvbkZpbHRlcnNDaGFuZ2U6IChmaWx0ZXJzOiBGaWx0ZXJPcHRpb25zKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBNYXRjaEZpbHRlcnMoeyBcbiAgbWF0Y2hlcywgXG4gIG9uRmlsdGVyZWRNYXRjaGVzLCBcbiAgb25GaWx0ZXJzQ2hhbmdlIFxufTogTWF0Y2hGaWx0ZXJzUHJvcHMpIHtcbiAgY29uc3QgeyB0IH0gPSB1c2VUcmFuc2xhdGlvbignbWF0Y2hlcycpO1xuICBcbiAgLy8gRGVwZW5kZW5jeSBpbmplY3Rpb24gZm9sbG93aW5nIERJUFxuICBjb25zdCBmaWx0ZXJTZXJ2aWNlID0gbmV3IE1hdGNoRmlsdGVyU2VydmljZShcbiAgICBuZXcgQ29uY3JldGVGaWx0ZXJTdHJhdGVneUZhY3RvcnkoKSxcbiAgICBuZXcgQ29uY3JldGVTb3J0U3RyYXRlZ3lGYWN0b3J5KClcbiAgKTtcbiAgY29uc3QgcGVyc2lzdGVuY2VSZXBvc2l0b3J5ID0gbmV3IExvY2FsU3RvcmFnZUZpbHRlclJlcG9zaXRvcnkoKTtcbiAgXG4gIGNvbnN0IFtmaWx0ZXJzLCBzZXRGaWx0ZXJzXSA9IHVzZVN0YXRlPEZpbHRlck9wdGlvbnM+KHtcbiAgICBtaW5TY29yZTogMCxcbiAgICBtaW5TZWF0czogMSxcbiAgICBkYXRlRnJvbTogJycsXG4gICAgZGF0ZVRvOiAnJyxcbiAgICBzb3J0Qnk6ICdzY29yZScsXG4gICAgc29ydE9yZGVyOiAnZGVzYydcbiAgfSk7XG5cbiAgY29uc3QgW2FjdGl2ZUZpbHRlcnNDb3VudCwgc2V0QWN0aXZlRmlsdGVyc0NvdW50XSA9IHVzZVN0YXRlKDApO1xuXG4gIC8vIExvYWQgZmlsdGVycyBmcm9tIHJlcG9zaXRvcnkgb24gbW91bnRcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBzYXZlZEZpbHRlcnMgPSBwZXJzaXN0ZW5jZVJlcG9zaXRvcnkubG9hZCgpO1xuICAgIGlmIChzYXZlZEZpbHRlcnMpIHtcbiAgICAgIHNldEZpbHRlcnMoc2F2ZWRGaWx0ZXJzKTtcbiAgICB9XG4gIH0sIFtdKTtcblxuICAvLyBTYXZlIGZpbHRlcnMgdG8gcmVwb3NpdG9yeSB3aGVuZXZlciB0aGV5IGNoYW5nZVxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHBlcnNpc3RlbmNlUmVwb3NpdG9yeS5zYXZlKGZpbHRlcnMpO1xuICB9LCBbZmlsdGVyc10pO1xuXG4gIC8vIEFwcGx5IGZpbHRlcnMgYW5kIHNvcnRpbmcgdXNpbmcgc2VydmljZVxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IGZpbHRlcmVkID0gZmlsdGVyU2VydmljZS5wcm9jZXNzTWF0Y2hlcyhtYXRjaGVzLCBmaWx0ZXJzKTtcbiAgICBvbkZpbHRlcmVkTWF0Y2hlcyhmaWx0ZXJlZCk7XG4gICAgb25GaWx0ZXJzQ2hhbmdlKGZpbHRlcnMpO1xuICB9LCBbbWF0Y2hlcywgZmlsdGVycywgb25GaWx0ZXJlZE1hdGNoZXMsIG9uRmlsdGVyc0NoYW5nZSwgZmlsdGVyU2VydmljZV0pO1xuXG4gIC8vIENvdW50IGFjdGl2ZSBmaWx0ZXJzIHVzaW5nIHNlcnZpY2VcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBhY3RpdmVGaWx0ZXJOYW1lcyA9IGZpbHRlclNlcnZpY2UuZ2V0QWN0aXZlRmlsdGVyTmFtZXMoZmlsdGVycyk7XG4gICAgc2V0QWN0aXZlRmlsdGVyc0NvdW50KGFjdGl2ZUZpbHRlck5hbWVzLmxlbmd0aCk7XG4gIH0sIFtmaWx0ZXJzLCBmaWx0ZXJTZXJ2aWNlXSk7XG5cbiAgY29uc3QgaGFuZGxlRmlsdGVyQ2hhbmdlID0gKGtleToga2V5b2YgRmlsdGVyT3B0aW9ucywgdmFsdWU6IGFueSkgPT4ge1xuICAgIHNldEZpbHRlcnMocHJldiA9PiAoe1xuICAgICAgLi4ucHJldixcbiAgICAgIFtrZXldOiB2YWx1ZVxuICAgIH0pKTtcbiAgfTtcblxuICBjb25zdCBjbGVhckZpbHRlcnMgPSAoKSA9PiB7XG4gICAgY29uc3QgZGVmYXVsdEZpbHRlcnM6IEZpbHRlck9wdGlvbnMgPSB7XG4gICAgICBtaW5TY29yZTogMCxcbiAgICAgIG1pblNlYXRzOiAxLFxuICAgICAgZGF0ZUZyb206ICcnLFxuICAgICAgZGF0ZVRvOiAnJyxcbiAgICAgIHNvcnRCeTogJ3Njb3JlJyxcbiAgICAgIHNvcnRPcmRlcjogJ2Rlc2MnXG4gICAgfTtcbiAgICBzZXRGaWx0ZXJzKGRlZmF1bHRGaWx0ZXJzKTtcbiAgICBwZXJzaXN0ZW5jZVJlcG9zaXRvcnkuY2xlYXIoKTtcbiAgfTtcblxuICBjb25zdCBzb3J0T3B0aW9ucyA9IFtcbiAgICB7IHZhbHVlOiAnc2NvcmUnLCBsYWJlbDogdCgnZmlsdGVycy5zb3J0LnNjb3JlJykgfSxcbiAgICB7IHZhbHVlOiAnZGF0ZScsIGxhYmVsOiB0KCdmaWx0ZXJzLnNvcnQuZGF0ZScpIH0sXG4gICAgeyB2YWx1ZTogJ3NlYXRzJywgbGFiZWw6IHQoJ2ZpbHRlcnMuc29ydC5zZWF0cycpIH1cbiAgXTtcblxuICBjb25zdCBvcmRlck9wdGlvbnMgPSBbXG4gICAgeyB2YWx1ZTogJ2Rlc2MnLCBsYWJlbDogdCgnZmlsdGVycy5vcmRlci5kZXNjJykgfSxcbiAgICB7IHZhbHVlOiAnYXNjJywgbGFiZWw6IHQoJ2ZpbHRlcnMub3JkZXIuYXNjJykgfVxuICBdO1xuXG4gIHJldHVybiAoXG4gICAgPENhcmQ+XG4gICAgICA8Q2FyZENvbnRlbnQ+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS00XCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGp1c3RpZnktYmV0d2VlbiBpdGVtcy1jZW50ZXJcIj5cbiAgICAgICAgICAgIDxoMyBjbGFzc05hbWU9XCJ0ZXh0LWxnIGZvbnQtc2VtaWJvbGQgdGV4dC1ncmF5LTkwMFwiPlxuICAgICAgICAgICAgICB7dCgnZmlsdGVycy50aXRsZScpfVxuICAgICAgICAgICAgPC9oMz5cbiAgICAgICAgICAgICAge2FjdGl2ZUZpbHRlcnNDb3VudCA+IDAgJiYgKFxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0yXCI+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LWdyYXktNTAwXCIgZGF0YS10ZXN0aWQ9XCJhY3RpdmUtY291bnRcIj5cbiAgICAgICAgICAgICAgICAgIHt0KCdmaWx0ZXJzLmFjdGl2ZUNvdW50JywgeyBjb3VudDogYWN0aXZlRmlsdGVyc0NvdW50IH0pfVxuICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICB2YXJpYW50PVwic2Vjb25kYXJ5XCJcbiAgICAgICAgICAgICAgICAgIHNpemU9XCJzbVwiXG4gICAgICAgICAgICAgICAgICBvbkNsaWNrPXtjbGVhckZpbHRlcnN9XG4gICAgICAgICAgICAgICAgICBkYXRhLXRlc3RpZD1cImNsZWFyLWZpbHRlcnNcIlxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgIHt0KCdmaWx0ZXJzLmNsZWFyJyl9XG4gICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZCBncmlkLWNvbHMtMSBtZDpncmlkLWNvbHMtMiBsZzpncmlkLWNvbHMtMyBnYXAtNFwiPlxuICAgICAgICAgICAgey8qIFNjb3JlIEZpbHRlciAqL31cbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgIDxsYWJlbCBjbGFzc05hbWU9XCJibG9jayB0ZXh0LXNtIGZvbnQtbWVkaXVtIHRleHQtZ3JheS03MDAgbWItMlwiPlxuICAgICAgICAgICAgICAgIHt0KCdmaWx0ZXJzLm1pblNjb3JlJyl9ICh7ZmlsdGVycy5taW5TY29yZX0lKVxuICAgICAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICB0eXBlPVwicmFuZ2VcIlxuICAgICAgICAgICAgICAgIG1pbj1cIjBcIlxuICAgICAgICAgICAgICAgIG1heD1cIjEwMFwiXG4gICAgICAgICAgICAgICAgc3RlcD1cIjEwXCJcbiAgICAgICAgICAgICAgICB2YWx1ZT17ZmlsdGVycy5taW5TY29yZX1cbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IGhhbmRsZUZpbHRlckNoYW5nZSgnbWluU2NvcmUnLCBwYXJzZUludChlLnRhcmdldC52YWx1ZSkpfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInctZnVsbCBoLTIgYmctZ3JheS0yMDAgcm91bmRlZC1sZyBhcHBlYXJhbmNlLW5vbmUgY3Vyc29yLXBvaW50ZXJcIlxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIHsvKiBTZWF0cyBGaWx0ZXIgKi99XG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwiYmxvY2sgdGV4dC1zbSBmb250LW1lZGl1bSB0ZXh0LWdyYXktNzAwIG1iLTJcIj5cbiAgICAgICAgICAgICAgICB7dCgnZmlsdGVycy5taW5TZWF0cycpfVxuICAgICAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgICAgICA8U2VsZWN0XG4gICAgICAgICAgICAgICAgdmFsdWU9e2ZpbHRlcnMubWluU2VhdHMudG9TdHJpbmcoKX1cbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IGhhbmRsZUZpbHRlckNoYW5nZSgnbWluU2VhdHMnLCBwYXJzZUludChlLnRhcmdldC52YWx1ZSkpfVxuICAgICAgICAgICAgICAgIG9wdGlvbnM9e0FycmF5LmZyb20oeyBsZW5ndGg6IDggfSwgKF8sIGkpID0+ICh7XG4gICAgICAgICAgICAgICAgICB2YWx1ZTogKGkgKyAxKS50b1N0cmluZygpLFxuICAgICAgICAgICAgICAgICAgbGFiZWw6IGAke2kgKyAxfSAke2kgPT09IDAgPyB0KCdmaWx0ZXJzLnNlYXQnKSA6IHQoJ2ZpbHRlcnMuc2VhdHMnKX1gXG4gICAgICAgICAgICAgICAgfSkpfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIHsvKiBEYXRlIEZyb20gKi99XG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICA8SW5wdXRcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnZmlsdGVycy5kYXRlRnJvbScpfVxuICAgICAgICAgICAgICAgIHR5cGU9XCJkYXRlXCJcbiAgICAgICAgICAgICAgICB2YWx1ZT17ZmlsdGVycy5kYXRlRnJvbX1cbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IGhhbmRsZUZpbHRlckNoYW5nZSgnZGF0ZUZyb20nLCBlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgey8qIERhdGUgVG8gKi99XG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICA8SW5wdXRcbiAgICAgICAgICAgICAgICBsYWJlbD17dCgnZmlsdGVycy5kYXRlVG8nKX1cbiAgICAgICAgICAgICAgICB0eXBlPVwiZGF0ZVwiXG4gICAgICAgICAgICAgICAgdmFsdWU9e2ZpbHRlcnMuZGF0ZVRvfVxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gaGFuZGxlRmlsdGVyQ2hhbmdlKCdkYXRlVG8nLCBlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgey8qIFNvcnQgQnkgKi99XG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICA8U2VsZWN0XG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ2ZpbHRlcnMuc29ydEJ5Jyl9XG4gICAgICAgICAgICAgICAgdmFsdWU9e2ZpbHRlcnMuc29ydEJ5fVxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gaGFuZGxlRmlsdGVyQ2hhbmdlKCdzb3J0QnknLCBlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICAgICAgb3B0aW9ucz17c29ydE9wdGlvbnN9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgey8qIFNvcnQgT3JkZXIgKi99XG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICA8U2VsZWN0XG4gICAgICAgICAgICAgICAgbGFiZWw9e3QoJ2ZpbHRlcnMuc29ydE9yZGVyJyl9XG4gICAgICAgICAgICAgICAgdmFsdWU9e2ZpbHRlcnMuc29ydE9yZGVyfVxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gaGFuZGxlRmlsdGVyQ2hhbmdlKCdzb3J0T3JkZXInLCBlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICAgICAgb3B0aW9ucz17b3JkZXJPcHRpb25zfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICB7LyogQWN0aXZlIEZpbHRlciBDaGlwcyAqL31cbiAgICAgICAgICB7YWN0aXZlRmlsdGVyc0NvdW50ID4gMCAmJiAoXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZmxleC13cmFwIGdhcC0yXCIgZGF0YS10ZXN0aWQ9XCJhY3RpdmUtZmlsdGVyc1wiPlxuICAgICAgICAgICAgICB7ZmlsdGVycy5taW5TY29yZSA+IDAgJiYgKFxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImlubGluZS1mbGV4IGl0ZW1zLWNlbnRlciBweC0yIHB5LTEgcm91bmRlZC1mdWxsIHRleHQteHMgZm9udC1tZWRpdW0gYmctYmx1ZS0xMDAgdGV4dC1ibHVlLTgwMFwiIGRhdGEtdGVzdGlkPVwic2NvcmUtY2hpcFwiPlxuICAgICAgICAgICAgICAgICAge3QoJ2ZpbHRlcnMuc2NvcmVDaGlwJywgeyBzY29yZTogZmlsdGVycy5taW5TY29yZSB9KX1cbiAgICAgICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gaGFuZGxlRmlsdGVyQ2hhbmdlKCdtaW5TY29yZScsIDApfVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJtbC0xIHRleHQtYmx1ZS02MDAgaG92ZXI6dGV4dC1ibHVlLTgwMFwiXG4gICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIMOXXG4gICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIHtmaWx0ZXJzLm1pblNlYXRzID4gMSAmJiAoXG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiaW5saW5lLWZsZXggaXRlbXMtY2VudGVyIHB4LTIgcHktMSByb3VuZGVkLWZ1bGwgdGV4dC14cyBmb250LW1lZGl1bSBiZy1ncmVlbi0xMDAgdGV4dC1ncmVlbi04MDBcIiBkYXRhLXRlc3RpZD1cInNlYXRzLWNoaXBcIj5cbiAgICAgICAgICAgICAgICAgIHt0KCdmaWx0ZXJzLnNlYXRzQ2hpcCcsIHsgc2VhdHM6IGZpbHRlcnMubWluU2VhdHMgfSl9XG4gICAgICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGhhbmRsZUZpbHRlckNoYW5nZSgnbWluU2VhdHMnLCAxKX1cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibWwtMSB0ZXh0LWdyZWVuLTYwMCBob3Zlcjp0ZXh0LWdyZWVuLTgwMFwiXG4gICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIMOXXG4gICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIHtmaWx0ZXJzLmRhdGVGcm9tICYmIChcbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJpbmxpbmUtZmxleCBpdGVtcy1jZW50ZXIgcHgtMiBweS0xIHJvdW5kZWQtZnVsbCB0ZXh0LXhzIGZvbnQtbWVkaXVtIGJnLXB1cnBsZS0xMDAgdGV4dC1wdXJwbGUtODAwXCIgZGF0YS10ZXN0aWQ9XCJkYXRlLWZyb20tY2hpcFwiPlxuICAgICAgICAgICAgICAgICAge3QoJ2ZpbHRlcnMuZnJvbUNoaXAnLCB7IGRhdGU6IG5ldyBEYXRlKGZpbHRlcnMuZGF0ZUZyb20pLnRvTG9jYWxlRGF0ZVN0cmluZygpIH0pfVxuICAgICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBoYW5kbGVGaWx0ZXJDaGFuZ2UoJ2RhdGVGcm9tJywgJycpfVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJtbC0xIHRleHQtcHVycGxlLTYwMCBob3Zlcjp0ZXh0LXB1cnBsZS04MDBcIlxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICDDl1xuICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICB7ZmlsdGVycy5kYXRlVG8gJiYgKFxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImlubGluZS1mbGV4IGl0ZW1zLWNlbnRlciBweC0yIHB5LTEgcm91bmRlZC1mdWxsIHRleHQteHMgZm9udC1tZWRpdW0gYmctcHVycGxlLTEwMCB0ZXh0LXB1cnBsZS04MDBcIiBkYXRhLXRlc3RpZD1cImRhdGUtdG8tY2hpcFwiPlxuICAgICAgICAgICAgICAgICAge3QoJ2ZpbHRlcnMudG9DaGlwJywgeyBkYXRlOiBuZXcgRGF0ZShmaWx0ZXJzLmRhdGVUbykudG9Mb2NhbGVEYXRlU3RyaW5nKCkgfSl9XG4gICAgICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGhhbmRsZUZpbHRlckNoYW5nZSgnZGF0ZVRvJywgJycpfVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJtbC0xIHRleHQtcHVycGxlLTYwMCBob3Zlcjp0ZXh0LXB1cnBsZS04MDBcIlxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICDDl1xuICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L0NhcmRDb250ZW50PlxuICAgIDwvQ2FyZD5cbiAgKTtcbn1cbiJdLCJ2ZXJzaW9uIjozfQ==