b3b428d00178f84c4af74641521c980d
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
// Mock env and keycloak
jest.mock('../env', () => ({
    env: {
        bookingApiBaseUrl: 'http://localhost:8083/api',
    },
}));
jest.mock('../auth/keycloak', () => ({
    getKeycloak: () => ({
        updateToken: jest.fn().mockResolvedValue(undefined),
        token: 'test-jwt-token',
    }),
}));
// Mock axios
jest.mock('axios', () => {
    const instance = {
        get: jest.fn(),
        post: jest.fn(),
        put: jest.fn(),
        interceptors: { request: { use: jest.fn((fn) => fn({ headers: {} })) } },
    };
    return {
        __esModule: true,
        default: {
            create: () => instance,
        },
        instance,
    };
});
const bookings_1 = require("./bookings");
describe('BookingsService API', () => {
    let mockAxiosInstance;
    beforeEach(() => {
        jest.clearAllMocks();
        const { instance } = jest.requireMock('axios');
        mockAxiosInstance = instance;
    });
    it('getMyBookings returns list of bookings', async () => {
        const bookings = [
            {
                id: 'b1',
                tripId: 't1',
                passengerId: 'u1',
                seatsRequested: 1,
                status: 'PENDING',
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString(),
            },
        ];
        mockAxiosInstance.get.mockResolvedValueOnce({ data: bookings });
        const result = await bookings_1.BookingsService.getMyBookings();
        expect(result).toEqual(bookings);
        expect(mockAxiosInstance.get).toHaveBeenCalledWith('/bookings');
    });
    it('createBooking posts payload and returns created booking', async () => {
        const payload = { tripId: 't1', seatsRequested: 1 };
        const created = {
            id: 'b2',
            tripId: 't1',
            passengerId: 'u1',
            seatsRequested: 1,
            status: 'PENDING',
            createdAt: new Date().toISOString(),
            updatedAt: new Date().toISOString(),
        };
        mockAxiosInstance.post.mockResolvedValueOnce({ data: created });
        const result = await bookings_1.BookingsService.createBooking(payload);
        expect(result).toEqual(created);
        expect(mockAxiosInstance.post).toHaveBeenCalledWith('/bookings', payload);
    });
    it('cancelBooking calls PUT and returns updated booking', async () => {
        const updated = {
            id: 'b3',
            tripId: 't1',
            passengerId: 'u1',
            seatsRequested: 1,
            status: 'CANCELLED',
            createdAt: new Date().toISOString(),
            updatedAt: new Date().toISOString(),
        };
        mockAxiosInstance.put.mockResolvedValueOnce({ data: updated });
        const result = await bookings_1.BookingsService.cancelBooking('b3');
        expect(result).toEqual(updated);
        expect(mockAxiosInstance.put).toHaveBeenCalledWith('/bookings/b3/cancel');
    });
    it('confirmBooking calls PUT and returns confirmed booking', async () => {
        const confirmed = {
            id: 'b4',
            tripId: 't1',
            passengerId: 'u1',
            seatsRequested: 1,
            status: 'CONFIRMED',
            createdAt: new Date().toISOString(),
            updatedAt: new Date().toISOString(),
        };
        mockAxiosInstance.put.mockResolvedValueOnce({ data: confirmed });
        const result = await bookings_1.BookingsService.confirmBooking('b4');
        expect(result).toEqual(confirmed);
        expect(mockAxiosInstance.put).toHaveBeenCalledWith('/bookings/b4/confirm');
    });
    it('propagates API errors (e.g., 400 when no seats available) on create', async () => {
        const payload = { tripId: 't1', seatsRequested: 2 };
        const error = Object.assign(new Error('Bad Request'), { response: { status: 400 } });
        mockAxiosInstance.post.mockRejectedValueOnce(error);
        await expect(bookings_1.BookingsService.createBooking(payload)).rejects.toBe(error);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9BSTREZXZzLWZpbmFscHJvamVjdC9Gcm9udGVuZC9zcmMvYXBpL2Jvb2tpbmdzLnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7QUFHQSx3QkFBd0I7QUFDeEIsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUN6QixHQUFHLEVBQUU7UUFDSCxpQkFBaUIsRUFBRSwyQkFBMkI7S0FDL0M7Q0FDRixDQUFDLENBQUMsQ0FBQztBQUVKLElBQUksQ0FBQyxJQUFJLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNuQyxXQUFXLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztRQUNsQixXQUFXLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGlCQUFpQixDQUFDLFNBQVMsQ0FBQztRQUNuRCxLQUFLLEVBQUUsZ0JBQWdCO0tBQ3hCLENBQUM7Q0FDSCxDQUFDLENBQUMsQ0FBQztBQUVKLGFBQWE7QUFDYixJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUU7SUFDdEIsTUFBTSxRQUFRLEdBQUc7UUFDZixHQUFHLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNkLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2YsR0FBRyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDZCxZQUFZLEVBQUUsRUFBRSxPQUFPLEVBQUUsRUFBRSxHQUFHLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQU8sRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsT0FBTyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFO0tBQzlFLENBQUM7SUFDRixPQUFPO1FBQ0wsVUFBVSxFQUFFLElBQUk7UUFDaEIsT0FBTyxFQUFFO1lBQ1AsTUFBTSxFQUFFLEdBQUcsRUFBRSxDQUFDLFFBQVE7U0FDdkI7UUFDRCxRQUFRO0tBQ1QsQ0FBQztBQUNKLENBQUMsQ0FBQyxDQUFDO0FBaENILHlDQUE2QztBQWtDN0MsUUFBUSxDQUFDLHFCQUFxQixFQUFFLEdBQUcsRUFBRTtJQUNuQyxJQUFJLGlCQUFzQixDQUFDO0lBRTNCLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDckIsTUFBTSxFQUFFLFFBQVEsRUFBRSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDL0MsaUJBQWlCLEdBQUcsUUFBUSxDQUFDO0lBQy9CLENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLHdDQUF3QyxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQ3RELE1BQU0sUUFBUSxHQUFHO1lBQ2Y7Z0JBQ0UsRUFBRSxFQUFFLElBQUk7Z0JBQ1IsTUFBTSxFQUFFLElBQUk7Z0JBQ1osV0FBVyxFQUFFLElBQUk7Z0JBQ2pCLGNBQWMsRUFBRSxDQUFDO2dCQUNqQixNQUFNLEVBQUUsU0FBUztnQkFDakIsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO2dCQUNuQyxTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUU7YUFDcEM7U0FDRixDQUFDO1FBQ0YsaUJBQWlCLENBQUMsR0FBRyxDQUFDLHFCQUFxQixDQUFDLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxDQUFDLENBQUM7UUFFaEUsTUFBTSxNQUFNLEdBQUcsTUFBTSwwQkFBZSxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ3JELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDakMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ2xFLENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLHlEQUF5RCxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQ3ZFLE1BQU0sT0FBTyxHQUFHLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxjQUFjLEVBQUUsQ0FBQyxFQUFFLENBQUM7UUFDcEQsTUFBTSxPQUFPLEdBQUc7WUFDZCxFQUFFLEVBQUUsSUFBSTtZQUNSLE1BQU0sRUFBRSxJQUFJO1lBQ1osV0FBVyxFQUFFLElBQUk7WUFDakIsY0FBYyxFQUFFLENBQUM7WUFDakIsTUFBTSxFQUFFLFNBQVM7WUFDakIsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO1lBQ25DLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRTtTQUNwQyxDQUFDO1FBQ0YsaUJBQWlCLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxDQUFDLENBQUM7UUFFaEUsTUFBTSxNQUFNLEdBQUcsTUFBTSwwQkFBZSxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUM1RCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ2hDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxXQUFXLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDNUUsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMscURBQXFELEVBQUUsS0FBSyxJQUFJLEVBQUU7UUFDbkUsTUFBTSxPQUFPLEdBQUc7WUFDZCxFQUFFLEVBQUUsSUFBSTtZQUNSLE1BQU0sRUFBRSxJQUFJO1lBQ1osV0FBVyxFQUFFLElBQUk7WUFDakIsY0FBYyxFQUFFLENBQUM7WUFDakIsTUFBTSxFQUFFLFdBQVc7WUFDbkIsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO1lBQ25DLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRTtTQUNwQyxDQUFDO1FBQ0YsaUJBQWlCLENBQUMsR0FBRyxDQUFDLHFCQUFxQixDQUFDLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxDQUFDLENBQUM7UUFFL0QsTUFBTSxNQUFNLEdBQUcsTUFBTSwwQkFBZSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN6RCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ2hDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO0lBQzVFLENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLHdEQUF3RCxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQ3RFLE1BQU0sU0FBUyxHQUFHO1lBQ2hCLEVBQUUsRUFBRSxJQUFJO1lBQ1IsTUFBTSxFQUFFLElBQUk7WUFDWixXQUFXLEVBQUUsSUFBSTtZQUNqQixjQUFjLEVBQUUsQ0FBQztZQUNqQixNQUFNLEVBQUUsV0FBVztZQUNuQixTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUU7WUFDbkMsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO1NBQ3BDLENBQUM7UUFDRixpQkFBaUIsQ0FBQyxHQUFHLENBQUMscUJBQXFCLENBQUMsRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLENBQUMsQ0FBQztRQUVqRSxNQUFNLE1BQU0sR0FBRyxNQUFNLDBCQUFlLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzFELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDbEMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLHNCQUFzQixDQUFDLENBQUM7SUFDN0UsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMscUVBQXFFLEVBQUUsS0FBSyxJQUFJLEVBQUU7UUFDbkYsTUFBTSxPQUFPLEdBQUcsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLGNBQWMsRUFBRSxDQUFDLEVBQUUsQ0FBQztRQUNwRCxNQUFNLEtBQUssR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksS0FBSyxDQUFDLGFBQWEsQ0FBQyxFQUFFLEVBQUUsUUFBUSxFQUFFLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUNyRixpQkFBaUIsQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsS0FBSyxDQUFDLENBQUM7UUFFcEQsTUFBTSxNQUFNLENBQUMsMEJBQWUsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzNFLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9BSTREZXZzLWZpbmFscHJvamVjdC9Gcm9udGVuZC9zcmMvYXBpL2Jvb2tpbmdzLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQm9va2luZ3NTZXJ2aWNlIH0gZnJvbSAnLi9ib29raW5ncyc7XG5pbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnO1xuXG4vLyBNb2NrIGVudiBhbmQga2V5Y2xvYWtcbmplc3QubW9jaygnLi4vZW52JywgKCkgPT4gKHtcbiAgZW52OiB7XG4gICAgYm9va2luZ0FwaUJhc2VVcmw6ICdodHRwOi8vbG9jYWxob3N0OjgwODMvYXBpJyxcbiAgfSxcbn0pKTtcblxuamVzdC5tb2NrKCcuLi9hdXRoL2tleWNsb2FrJywgKCkgPT4gKHtcbiAgZ2V0S2V5Y2xvYWs6ICgpID0+ICh7XG4gICAgdXBkYXRlVG9rZW46IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpLFxuICAgIHRva2VuOiAndGVzdC1qd3QtdG9rZW4nLFxuICB9KSxcbn0pKTtcblxuLy8gTW9jayBheGlvc1xuamVzdC5tb2NrKCdheGlvcycsICgpID0+IHtcbiAgY29uc3QgaW5zdGFuY2UgPSB7XG4gICAgZ2V0OiBqZXN0LmZuKCksXG4gICAgcG9zdDogamVzdC5mbigpLFxuICAgIHB1dDogamVzdC5mbigpLFxuICAgIGludGVyY2VwdG9yczogeyByZXF1ZXN0OiB7IHVzZTogamVzdC5mbigoZm46IGFueSkgPT4gZm4oeyBoZWFkZXJzOiB7fSB9KSkgfSB9LFxuICB9O1xuICByZXR1cm4ge1xuICAgIF9fZXNNb2R1bGU6IHRydWUsXG4gICAgZGVmYXVsdDoge1xuICAgICAgY3JlYXRlOiAoKSA9PiBpbnN0YW5jZSxcbiAgICB9LFxuICAgIGluc3RhbmNlLFxuICB9O1xufSk7XG5cbmRlc2NyaWJlKCdCb29raW5nc1NlcnZpY2UgQVBJJywgKCkgPT4ge1xuICBsZXQgbW9ja0F4aW9zSW5zdGFuY2U6IGFueTtcbiAgXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIGNvbnN0IHsgaW5zdGFuY2UgfSA9IGplc3QucmVxdWlyZU1vY2soJ2F4aW9zJyk7XG4gICAgbW9ja0F4aW9zSW5zdGFuY2UgPSBpbnN0YW5jZTtcbiAgfSk7XG5cbiAgaXQoJ2dldE15Qm9va2luZ3MgcmV0dXJucyBsaXN0IG9mIGJvb2tpbmdzJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGJvb2tpbmdzID0gW1xuICAgICAge1xuICAgICAgICBpZDogJ2IxJyxcbiAgICAgICAgdHJpcElkOiAndDEnLFxuICAgICAgICBwYXNzZW5nZXJJZDogJ3UxJyxcbiAgICAgICAgc2VhdHNSZXF1ZXN0ZWQ6IDEsXG4gICAgICAgIHN0YXR1czogJ1BFTkRJTkcnLFxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB9LFxuICAgIF07XG4gICAgbW9ja0F4aW9zSW5zdGFuY2UuZ2V0Lm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7IGRhdGE6IGJvb2tpbmdzIH0pO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgQm9va2luZ3NTZXJ2aWNlLmdldE15Qm9va2luZ3MoKTtcbiAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKGJvb2tpbmdzKTtcbiAgICBleHBlY3QobW9ja0F4aW9zSW5zdGFuY2UuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2Jvb2tpbmdzJyk7XG4gIH0pO1xuXG4gIGl0KCdjcmVhdGVCb29raW5nIHBvc3RzIHBheWxvYWQgYW5kIHJldHVybnMgY3JlYXRlZCBib29raW5nJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHBheWxvYWQgPSB7IHRyaXBJZDogJ3QxJywgc2VhdHNSZXF1ZXN0ZWQ6IDEgfTtcbiAgICBjb25zdCBjcmVhdGVkID0ge1xuICAgICAgaWQ6ICdiMicsXG4gICAgICB0cmlwSWQ6ICd0MScsXG4gICAgICBwYXNzZW5nZXJJZDogJ3UxJyxcbiAgICAgIHNlYXRzUmVxdWVzdGVkOiAxLFxuICAgICAgc3RhdHVzOiAnUEVORElORycsXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgIH07XG4gICAgbW9ja0F4aW9zSW5zdGFuY2UucG9zdC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoeyBkYXRhOiBjcmVhdGVkIH0pO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgQm9va2luZ3NTZXJ2aWNlLmNyZWF0ZUJvb2tpbmcocGF5bG9hZCk7XG4gICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChjcmVhdGVkKTtcbiAgICBleHBlY3QobW9ja0F4aW9zSW5zdGFuY2UucG9zdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9ib29raW5ncycsIHBheWxvYWQpO1xuICB9KTtcblxuICBpdCgnY2FuY2VsQm9va2luZyBjYWxscyBQVVQgYW5kIHJldHVybnMgdXBkYXRlZCBib29raW5nJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHVwZGF0ZWQgPSB7XG4gICAgICBpZDogJ2IzJyxcbiAgICAgIHRyaXBJZDogJ3QxJyxcbiAgICAgIHBhc3NlbmdlcklkOiAndTEnLFxuICAgICAgc2VhdHNSZXF1ZXN0ZWQ6IDEsXG4gICAgICBzdGF0dXM6ICdDQU5DRUxMRUQnLFxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICB9O1xuICAgIG1vY2tBeGlvc0luc3RhbmNlLnB1dC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoeyBkYXRhOiB1cGRhdGVkIH0pO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgQm9va2luZ3NTZXJ2aWNlLmNhbmNlbEJvb2tpbmcoJ2IzJyk7XG4gICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh1cGRhdGVkKTtcbiAgICBleHBlY3QobW9ja0F4aW9zSW5zdGFuY2UucHV0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2Jvb2tpbmdzL2IzL2NhbmNlbCcpO1xuICB9KTtcblxuICBpdCgnY29uZmlybUJvb2tpbmcgY2FsbHMgUFVUIGFuZCByZXR1cm5zIGNvbmZpcm1lZCBib29raW5nJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGNvbmZpcm1lZCA9IHtcbiAgICAgIGlkOiAnYjQnLFxuICAgICAgdHJpcElkOiAndDEnLFxuICAgICAgcGFzc2VuZ2VySWQ6ICd1MScsXG4gICAgICBzZWF0c1JlcXVlc3RlZDogMSxcbiAgICAgIHN0YXR1czogJ0NPTkZJUk1FRCcsXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgIH07XG4gICAgbW9ja0F4aW9zSW5zdGFuY2UucHV0Lm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7IGRhdGE6IGNvbmZpcm1lZCB9KTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IEJvb2tpbmdzU2VydmljZS5jb25maXJtQm9va2luZygnYjQnKTtcbiAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKGNvbmZpcm1lZCk7XG4gICAgZXhwZWN0KG1vY2tBeGlvc0luc3RhbmNlLnB1dCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9ib29raW5ncy9iNC9jb25maXJtJyk7XG4gIH0pO1xuXG4gIGl0KCdwcm9wYWdhdGVzIEFQSSBlcnJvcnMgKGUuZy4sIDQwMCB3aGVuIG5vIHNlYXRzIGF2YWlsYWJsZSkgb24gY3JlYXRlJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHBheWxvYWQgPSB7IHRyaXBJZDogJ3QxJywgc2VhdHNSZXF1ZXN0ZWQ6IDIgfTtcbiAgICBjb25zdCBlcnJvciA9IE9iamVjdC5hc3NpZ24obmV3IEVycm9yKCdCYWQgUmVxdWVzdCcpLCB7IHJlc3BvbnNlOiB7IHN0YXR1czogNDAwIH0gfSk7XG4gICAgbW9ja0F4aW9zSW5zdGFuY2UucG9zdC5tb2NrUmVqZWN0ZWRWYWx1ZU9uY2UoZXJyb3IpO1xuXG4gICAgYXdhaXQgZXhwZWN0KEJvb2tpbmdzU2VydmljZS5jcmVhdGVCb29raW5nKHBheWxvYWQpKS5yZWplY3RzLnRvQmUoZXJyb3IpO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==