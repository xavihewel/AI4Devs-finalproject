7d5759063a0a4ca7f5bc65335940afdd
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.RatingForm = RatingForm;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = __importStar(require("react"));
const ratings_1 = require("../../api/ratings");
const Button_1 = require("../ui/Button");
const Card_1 = require("../ui/Card");
const COMMON_TAGS = [
    'puntual',
    'amigable',
    'seguro',
    'respetuoso',
    'comunicativo',
    'flexible',
    'organizado',
    'confiable'
];
function RatingForm({ ratedUserId, ratedUserName, tripId, onSuccess, onCancel }) {
    const [ratingType, setRatingType] = (0, react_1.useState)('THUMBS_UP');
    const [selectedTags, setSelectedTags] = (0, react_1.useState)([]);
    const [comment, setComment] = (0, react_1.useState)('');
    const [loading, setLoading] = (0, react_1.useState)(false);
    const [error, setError] = (0, react_1.useState)(null);
    const [success, setSuccess] = (0, react_1.useState)(false);
    const handleTagToggle = (tag) => {
        setSelectedTags(prev => prev.includes(tag)
            ? prev.filter(t => t !== tag)
            : [...prev, tag]);
    };
    const handleSubmit = async (e) => {
        e.preventDefault();
        if (selectedTags.length === 0) {
            setError('Selecciona al menos una etiqueta');
            return;
        }
        try {
            setLoading(true);
            setError(null);
            setSuccess(false);
            const ratingData = {
                ratedId: ratedUserId,
                tripId,
                ratingType,
                tags: selectedTags,
                comment: comment.trim() || undefined
            };
            await ratings_1.RatingsService.createRating(ratingData);
            setSuccess(true);
            // Auto-close after showing success message
            setTimeout(() => {
                onSuccess?.();
            }, 2000);
        }
        catch (err) {
            setError('Error al crear la valoración');
            console.error('Error creating rating:', err);
        }
        finally {
            setLoading(false);
        }
    };
    return ((0, jsx_runtime_1.jsx)(Card_1.Card, { children: (0, jsx_runtime_1.jsxs)("div", { className: "p-6", children: [(0, jsx_runtime_1.jsxs)("h3", { className: "text-lg font-semibold text-gray-900 mb-4", children: ["Valorar a ", ratedUserName || 'usuario'] }), (0, jsx_runtime_1.jsxs)("form", { onSubmit: handleSubmit, className: "space-y-4", children: [(0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("label", { className: "block text-sm font-medium text-gray-700 mb-2", children: "Tipo de valoraci\u00F3n" }), (0, jsx_runtime_1.jsxs)("div", { className: "flex space-x-4", children: [(0, jsx_runtime_1.jsxs)("label", { className: "flex items-center", children: [(0, jsx_runtime_1.jsx)("input", { type: "radio", name: "ratingType", value: "THUMBS_UP", checked: ratingType === 'THUMBS_UP', onChange: (e) => setRatingType(e.target.value), className: "mr-2" }), (0, jsx_runtime_1.jsx)("span", { className: "text-green-600", children: "\uD83D\uDC4D Positivo" })] }), (0, jsx_runtime_1.jsxs)("label", { className: "flex items-center", children: [(0, jsx_runtime_1.jsx)("input", { type: "radio", name: "ratingType", value: "THUMBS_DOWN", checked: ratingType === 'THUMBS_DOWN', onChange: (e) => setRatingType(e.target.value), className: "mr-2" }), (0, jsx_runtime_1.jsx)("span", { className: "text-red-600", children: "\uD83D\uDC4E Negativo" })] })] })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("label", { className: "block text-sm font-medium text-gray-700 mb-2", children: "Etiquetas (selecciona al menos una)" }), (0, jsx_runtime_1.jsx)("div", { className: "grid grid-cols-2 gap-2", children: COMMON_TAGS.map((tag) => ((0, jsx_runtime_1.jsxs)("label", { className: "flex items-center", children: [(0, jsx_runtime_1.jsx)("input", { type: "checkbox", checked: selectedTags.includes(tag), onChange: () => handleTagToggle(tag), className: "mr-2" }), (0, jsx_runtime_1.jsx)("span", { className: "text-sm", children: tag })] }, tag))) })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("label", { className: "block text-sm font-medium text-gray-700 mb-2", children: "Comentario (opcional)" }), (0, jsx_runtime_1.jsx)("textarea", { value: comment, onChange: (e) => setComment(e.target.value), placeholder: "Describe tu experiencia...", className: "w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500", rows: 3 })] }), success && ((0, jsx_runtime_1.jsx)("div", { className: "bg-green-50 border border-green-200 rounded-md p-4", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex", children: [(0, jsx_runtime_1.jsx)("div", { className: "flex-shrink-0", children: (0, jsx_runtime_1.jsx)("svg", { className: "h-5 w-5 text-green-400", viewBox: "0 0 20 20", fill: "currentColor", children: (0, jsx_runtime_1.jsx)("path", { fillRule: "evenodd", d: "M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z", clipRule: "evenodd" }) }) }), (0, jsx_runtime_1.jsxs)("div", { className: "ml-3", children: [(0, jsx_runtime_1.jsx)("h3", { className: "text-sm font-medium text-green-800", children: "\u00A1Valoraci\u00F3n enviada correctamente!" }), (0, jsx_runtime_1.jsx)("div", { className: "mt-2 text-sm text-green-700", children: (0, jsx_runtime_1.jsx)("p", { children: "Tu valoraci\u00F3n ha sido guardada y ser\u00E1 visible para otros usuarios." }) })] })] }) })), error && ((0, jsx_runtime_1.jsx)("div", { className: "bg-red-50 border border-red-200 rounded-md p-4", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex", children: [(0, jsx_runtime_1.jsx)("div", { className: "flex-shrink-0", children: (0, jsx_runtime_1.jsx)("svg", { className: "h-5 w-5 text-red-400", viewBox: "0 0 20 20", fill: "currentColor", children: (0, jsx_runtime_1.jsx)("path", { fillRule: "evenodd", d: "M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z", clipRule: "evenodd" }) }) }), (0, jsx_runtime_1.jsxs)("div", { className: "ml-3", children: [(0, jsx_runtime_1.jsx)("h3", { className: "text-sm font-medium text-red-800", children: "Error al enviar la valoraci\u00F3n" }), (0, jsx_runtime_1.jsx)("div", { className: "mt-2 text-sm text-red-700", children: (0, jsx_runtime_1.jsx)("p", { children: error }) })] })] }) })), (0, jsx_runtime_1.jsxs)("div", { className: "flex justify-end space-x-3", children: [onCancel && !success && ((0, jsx_runtime_1.jsx)(Button_1.Button, { type: "button", variant: "secondary", onClick: onCancel, disabled: loading, children: "Cancelar" })), (0, jsx_runtime_1.jsx)(Button_1.Button, { type: "submit", disabled: loading || selectedTags.length === 0 || success, children: loading ? 'Guardando...' : success ? '¡Enviado!' : 'Enviar Valoración' })] })] })] }) }));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9BSTREZXZzLWZpbmFscHJvamVjdC9Gcm9udGVuZC9zcmMvY29tcG9uZW50cy90cnVzdC9SYXRpbmdGb3JtLnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXlCQSxnQ0E4TEM7O0FBdk5ELCtDQUF3QztBQUN4QywrQ0FBb0U7QUFDcEUseUNBQXNDO0FBRXRDLHFDQUFrQztBQVVsQyxNQUFNLFdBQVcsR0FBRztJQUNsQixTQUFTO0lBQ1QsVUFBVTtJQUNWLFFBQVE7SUFDUixZQUFZO0lBQ1osY0FBYztJQUNkLFVBQVU7SUFDVixZQUFZO0lBQ1osV0FBVztDQUNaLENBQUM7QUFFRixTQUFnQixVQUFVLENBQUMsRUFBRSxXQUFXLEVBQUUsYUFBYSxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFtQjtJQUNyRyxNQUFNLENBQUMsVUFBVSxFQUFFLGFBQWEsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBOEIsV0FBVyxDQUFDLENBQUM7SUFDdkYsTUFBTSxDQUFDLFlBQVksRUFBRSxlQUFlLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQVcsRUFBRSxDQUFDLENBQUM7SUFDL0QsTUFBTSxDQUFDLE9BQU8sRUFBRSxVQUFVLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsRUFBRSxDQUFDLENBQUM7SUFDM0MsTUFBTSxDQUFDLE9BQU8sRUFBRSxVQUFVLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsS0FBSyxDQUFDLENBQUM7SUFDOUMsTUFBTSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQWdCLElBQUksQ0FBQyxDQUFDO0lBQ3hELE1BQU0sQ0FBQyxPQUFPLEVBQUUsVUFBVSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLEtBQUssQ0FBQyxDQUFDO0lBRTlDLE1BQU0sZUFBZSxHQUFHLENBQUMsR0FBVyxFQUFFLEVBQUU7UUFDdEMsZUFBZSxDQUFDLElBQUksQ0FB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STREZXZzLWZpbmFscHJvamVjdC9Gcm9udGVuZC9zcmMvY29tcG9uZW50cy90cnVzdC9SYXRpbmdGb3JtLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBSYXRpbmdzU2VydmljZSwgUmF0aW5nQ3JlYXRlRHRvIH0gZnJvbSAnLi4vLi4vYXBpL3JhdGluZ3MnO1xuaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSAnLi4vdWkvQnV0dG9uJztcbmltcG9ydCB7IElucHV0IH0gZnJvbSAnLi4vdWkvSW5wdXQnO1xuaW1wb3J0IHsgQ2FyZCB9IGZyb20gJy4uL3VpL0NhcmQnO1xuXG5pbnRlcmZhY2UgUmF0aW5nRm9ybVByb3BzIHtcbiAgcmF0ZWRVc2VySWQ6IHN0cmluZztcbiAgcmF0ZWRVc2VyTmFtZT86IHN0cmluZztcbiAgdHJpcElkPzogc3RyaW5nO1xuICBvblN1Y2Nlc3M/OiAoKSA9PiB2b2lkO1xuICBvbkNhbmNlbD86ICgpID0+IHZvaWQ7XG59XG5cbmNvbnN0IENPTU1PTl9UQUdTID0gW1xuICAncHVudHVhbCcsXG4gICdhbWlnYWJsZScsXG4gICdzZWd1cm8nLFxuICAncmVzcGV0dW9zbycsXG4gICdjb211bmljYXRpdm8nLFxuICAnZmxleGlibGUnLFxuICAnb3JnYW5pemFkbycsXG4gICdjb25maWFibGUnXG5dO1xuXG5leHBvcnQgZnVuY3Rpb24gUmF0aW5nRm9ybSh7IHJhdGVkVXNlcklkLCByYXRlZFVzZXJOYW1lLCB0cmlwSWQsIG9uU3VjY2Vzcywgb25DYW5jZWwgfTogUmF0aW5nRm9ybVByb3BzKSB7XG4gIGNvbnN0IFtyYXRpbmdUeXBlLCBzZXRSYXRpbmdUeXBlXSA9IHVzZVN0YXRlPCdUSFVNQlNfVVAnIHwgJ1RIVU1CU19ET1dOJz4oJ1RIVU1CU19VUCcpO1xuICBjb25zdCBbc2VsZWN0ZWRUYWdzLCBzZXRTZWxlY3RlZFRhZ3NdID0gdXNlU3RhdGU8c3RyaW5nW10+KFtdKTtcbiAgY29uc3QgW2NvbW1lbnQsIHNldENvbW1lbnRdID0gdXNlU3RhdGUoJycpO1xuICBjb25zdCBbbG9hZGluZywgc2V0TG9hZGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtlcnJvciwgc2V0RXJyb3JdID0gdXNlU3RhdGU8c3RyaW5nIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFtzdWNjZXNzLCBzZXRTdWNjZXNzXSA9IHVzZVN0YXRlKGZhbHNlKTtcblxuICBjb25zdCBoYW5kbGVUYWdUb2dnbGUgPSAodGFnOiBzdHJpbmcpID0+IHtcbiAgICBzZXRTZWxlY3RlZFRhZ3MocHJldiA9PiBcbiAgICAgIHByZXYuaW5jbHVkZXModGFnKSBcbiAgICAgICAgPyBwcmV2LmZpbHRlcih0ID0+IHQgIT09IHRhZylcbiAgICAgICAgOiBbLi4ucHJldiwgdGFnXVxuICAgICk7XG4gIH07XG5cbiAgY29uc3QgaGFuZGxlU3VibWl0ID0gYXN5bmMgKGU6IFJlYWN0LkZvcm1FdmVudCkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBcbiAgICBpZiAoc2VsZWN0ZWRUYWdzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgc2V0RXJyb3IoJ1NlbGVjY2lvbmEgYWwgbWVub3MgdW5hIGV0aXF1ZXRhJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIHNldExvYWRpbmcodHJ1ZSk7XG4gICAgICBzZXRFcnJvcihudWxsKTtcbiAgICAgIHNldFN1Y2Nlc3MoZmFsc2UpO1xuXG4gICAgICBjb25zdCByYXRpbmdEYXRhOiBSYXRpbmdDcmVhdGVEdG8gPSB7XG4gICAgICAgIHJhdGVkSWQ6IHJhdGVkVXNlcklkLFxuICAgICAgICB0cmlwSWQsXG4gICAgICAgIHJhdGluZ1R5cGUsXG4gICAgICAgIHRhZ3M6IHNlbGVjdGVkVGFncyxcbiAgICAgICAgY29tbWVudDogY29tbWVudC50cmltKCkgfHwgdW5kZWZpbmVkXG4gICAgICB9O1xuXG4gICAgICBhd2FpdCBSYXRpbmdzU2VydmljZS5jcmVhdGVSYXRpbmcocmF0aW5nRGF0YSk7XG4gICAgICBzZXRTdWNjZXNzKHRydWUpO1xuICAgICAgXG4gICAgICAvLyBBdXRvLWNsb3NlIGFmdGVyIHNob3dpbmcgc3VjY2VzcyBtZXNzYWdlXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgb25TdWNjZXNzPy4oKTtcbiAgICAgIH0sIDIwMDApO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgc2V0RXJyb3IoJ0Vycm9yIGFsIGNyZWFyIGxhIHZhbG9yYWNpw7NuJyk7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyByYXRpbmc6JywgZXJyKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPENhcmQ+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInAtNlwiPlxuICAgICAgICA8aDMgY2xhc3NOYW1lPVwidGV4dC1sZyBmb250LXNlbWlib2xkIHRleHQtZ3JheS05MDAgbWItNFwiPlxuICAgICAgICAgIFZhbG9yYXIgYSB7cmF0ZWRVc2VyTmFtZSB8fCAndXN1YXJpbyd9XG4gICAgICAgIDwvaDM+XG5cbiAgICAgICAgPGZvcm0gb25TdWJtaXQ9e2hhbmRsZVN1Ym1pdH0gY2xhc3NOYW1lPVwic3BhY2UteS00XCI+XG4gICAgICAgICAgey8qIFJhdGluZyBUeXBlICovfVxuICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwiYmxvY2sgdGV4dC1zbSBmb250LW1lZGl1bSB0ZXh0LWdyYXktNzAwIG1iLTJcIj5cbiAgICAgICAgICAgICAgVGlwbyBkZSB2YWxvcmFjacOzblxuICAgICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBzcGFjZS14LTRcIj5cbiAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICB0eXBlPVwicmFkaW9cIlxuICAgICAgICAgICAgICAgICAgbmFtZT1cInJhdGluZ1R5cGVcIlxuICAgICAgICAgICAgICAgICAgdmFsdWU9XCJUSFVNQlNfVVBcIlxuICAgICAgICAgICAgICAgICAgY2hlY2tlZD17cmF0aW5nVHlwZSA9PT0gJ1RIVU1CU19VUCd9XG4gICAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldFJhdGluZ1R5cGUoZS50YXJnZXQudmFsdWUgYXMgJ1RIVU1CU19VUCcpfVxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXItMlwiXG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LWdyZWVuLTYwMFwiPvCfkY0gUG9zaXRpdm88L3NwYW4+XG4gICAgICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICAgICAgIDxsYWJlbCBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlclwiPlxuICAgICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgICAgdHlwZT1cInJhZGlvXCJcbiAgICAgICAgICAgICAgICAgIG5hbWU9XCJyYXRpbmdUeXBlXCJcbiAgICAgICAgICAgICAgICAgIHZhbHVlPVwiVEhVTUJTX0RPV05cIlxuICAgICAgICAgICAgICAgICAgY2hlY2tlZD17cmF0aW5nVHlwZSA9PT0gJ1RIVU1CU19ET1dOJ31cbiAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0UmF0aW5nVHlwZShlLnRhcmdldC52YWx1ZSBhcyAnVEhVTUJTX0RPV04nKX1cbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm1yLTJcIlxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC1yZWQtNjAwXCI+8J+RjiBOZWdhdGl2bzwvc3Bhbj5cbiAgICAgICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgey8qIFRhZ3MgKi99XG4gICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgIDxsYWJlbCBjbGFzc05hbWU9XCJibG9jayB0ZXh0LXNtIGZvbnQtbWVkaXVtIHRleHQtZ3JheS03MDAgbWItMlwiPlxuICAgICAgICAgICAgICBFdGlxdWV0YXMgKHNlbGVjY2lvbmEgYWwgbWVub3MgdW5hKVxuICAgICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZCBncmlkLWNvbHMtMiBnYXAtMlwiPlxuICAgICAgICAgICAgICB7Q09NTU9OX1RBR1MubWFwKCh0YWcpID0+IChcbiAgICAgICAgICAgICAgICA8bGFiZWwga2V5PXt0YWd9IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICAgICAgdHlwZT1cImNoZWNrYm94XCJcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17c2VsZWN0ZWRUYWdzLmluY2x1ZGVzKHRhZyl9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoKSA9PiBoYW5kbGVUYWdUb2dnbGUodGFnKX1cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXItMlwiXG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC1zbVwiPnt0YWd9PC9zcGFuPlxuICAgICAgICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICB7LyogQ29tbWVudCAqL31cbiAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPGxhYmVsIGNsYXNzTmFtZT1cImJsb2NrIHRleHQtc20gZm9udC1tZWRpdW0gdGV4dC1ncmF5LTcwMCBtYi0yXCI+XG4gICAgICAgICAgICAgIENvbWVudGFyaW8gKG9wY2lvbmFsKVxuICAgICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICAgIDx0ZXh0YXJlYVxuICAgICAgICAgICAgICB2YWx1ZT17Y29tbWVudH1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXRDb21tZW50KGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJEZXNjcmliZSB0dSBleHBlcmllbmNpYS4uLlwiXG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cInctZnVsbCBweC0zIHB5LTIgYm9yZGVyIGJvcmRlci1ncmF5LTMwMCByb3VuZGVkLW1kIHNoYWRvdy1zbSBmb2N1czpvdXRsaW5lLW5vbmUgZm9jdXM6cmluZy0yIGZvY3VzOnJpbmctcHJpbWFyeS01MDAgZm9jdXM6Ym9yZGVyLXByaW1hcnktNTAwXCJcbiAgICAgICAgICAgICAgcm93cz17M31cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICB7LyogU3VjY2VzcyBNZXNzYWdlICovfVxuICAgICAgICAgIHtzdWNjZXNzICYmIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYmctZ3JlZW4tNTAgYm9yZGVyIGJvcmRlci1ncmVlbi0yMDAgcm91bmRlZC1tZCBwLTRcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4XCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LXNocmluay0wXCI+XG4gICAgICAgICAgICAgICAgICA8c3ZnIGNsYXNzTmFtZT1cImgtNSB3LTUgdGV4dC1ncmVlbi00MDBcIiB2aWV3Qm94PVwiMCAwIDIwIDIwXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiPlxuICAgICAgICAgICAgICAgICAgICA8cGF0aCBmaWxsUnVsZT1cImV2ZW5vZGRcIiBkPVwiTTEwIDE4YTggOCAwIDEwMC0xNiA4IDggMCAwMDAgMTZ6bTMuNzA3LTkuMjkzYTEgMSAwIDAwLTEuNDE0LTEuNDE0TDkgMTAuNTg2IDcuNzA3IDkuMjkzYTEgMSAwIDAwLTEuNDE0IDEuNDE0bDIgMmExIDEgMCAwMDEuNDE0IDBsNC00elwiIGNsaXBSdWxlPVwiZXZlbm9kZFwiIC8+XG4gICAgICAgICAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1sLTNcIj5cbiAgICAgICAgICAgICAgICAgIDxoMyBjbGFzc05hbWU9XCJ0ZXh0LXNtIGZvbnQtbWVkaXVtIHRleHQtZ3JlZW4tODAwXCI+XG4gICAgICAgICAgICAgICAgICAgIMKhVmFsb3JhY2nDs24gZW52aWFkYSBjb3JyZWN0YW1lbnRlIVxuICAgICAgICAgICAgICAgICAgPC9oMz5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXQtMiB0ZXh0LXNtIHRleHQtZ3JlZW4tNzAwXCI+XG4gICAgICAgICAgICAgICAgICAgIDxwPlR1IHZhbG9yYWNpw7NuIGhhIHNpZG8gZ3VhcmRhZGEgeSBzZXLDoSB2aXNpYmxlIHBhcmEgb3Ryb3MgdXN1YXJpb3MuPC9wPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgKX1cblxuICAgICAgICAgIHsvKiBFcnJvciBNZXNzYWdlICovfVxuICAgICAgICAgIHtlcnJvciAmJiAoXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJnLXJlZC01MCBib3JkZXIgYm9yZGVyLXJlZC0yMDAgcm91bmRlZC1tZCBwLTRcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4XCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LXNocmluay0wXCI+XG4gICAgICAgICAgICAgICAgICA8c3ZnIGNsYXNzTmFtZT1cImgtNSB3LTUgdGV4dC1yZWQtNDAwXCIgdmlld0JveD1cIjAgMCAyMCAyMFwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIj5cbiAgICAgICAgICAgICAgICAgICAgPHBhdGggZmlsbFJ1bGU9XCJldmVub2RkXCIgZD1cIk0xMCAxOGE4IDggMCAxMDAtMTYgOCA4IDAgMDAwIDE2ek04LjcwNyA3LjI5M2ExIDEgMCAwMC0xLjQxNCAxLjQxNEw4LjU4NiAxMGwtMS4yOTMgMS4yOTNhMSAxIDAgMTAxLjQxNCAxLjQxNEwxMCAxMS40MTRsMS4yOTMgMS4yOTNhMSAxIDAgMDAxLjQxNC0xLjQxNEwxMS40MTQgMTBsMS4yOTMtMS4yOTNhMSAxIDAgMDAtMS40MTQtMS40MTRMMTAgOC41ODYgOC43MDcgNy4yOTN6XCIgY2xpcFJ1bGU9XCJldmVub2RkXCIgLz5cbiAgICAgICAgICAgICAgICAgIDwvc3ZnPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWwtM1wiPlxuICAgICAgICAgICAgICAgICAgPGgzIGNsYXNzTmFtZT1cInRleHQtc20gZm9udC1tZWRpdW0gdGV4dC1yZWQtODAwXCI+XG4gICAgICAgICAgICAgICAgICAgIEVycm9yIGFsIGVudmlhciBsYSB2YWxvcmFjacOzblxuICAgICAgICAgICAgICAgICAgPC9oMz5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXQtMiB0ZXh0LXNtIHRleHQtcmVkLTcwMFwiPlxuICAgICAgICAgICAgICAgICAgICA8cD57ZXJyb3J9PC9wPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgKX1cblxuICAgICAgICAgIHsvKiBBY3Rpb25zICovfVxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBqdXN0aWZ5LWVuZCBzcGFjZS14LTNcIj5cbiAgICAgICAgICAgIHtvbkNhbmNlbCAmJiAhc3VjY2VzcyAmJiAoXG4gICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICB2YXJpYW50PVwic2Vjb25kYXJ5XCJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXtvbkNhbmNlbH1cbiAgICAgICAgICAgICAgICBkaXNhYmxlZD17bG9hZGluZ31cbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIENhbmNlbGFyXG4gICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgdHlwZT1cInN1Ym1pdFwiXG4gICAgICAgICAgICAgIGRpc2FibGVkPXtsb2FkaW5nIHx8IHNlbGVjdGVkVGFncy5sZW5ndGggPT09IDAgfHwgc3VjY2Vzc31cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAge2xvYWRpbmcgPyAnR3VhcmRhbmRvLi4uJyA6IHN1Y2Nlc3MgPyAnwqFFbnZpYWRvIScgOiAnRW52aWFyIFZhbG9yYWNpw7NuJ31cbiAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Zvcm0+XG4gICAgICA8L2Rpdj5cbiAgICA8L0NhcmQ+XG4gICk7XG59XG5cbiJdLCJ2ZXJzaW9uIjozfQ==